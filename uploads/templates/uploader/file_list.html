{% extends "base.html" %}

{% block title %}Artifact Registry - Secure Gateway{% endblock %}

{% block content %}
<div class="secure-card wide">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
        <h2 class="card-title" style="margin:0; text-align:left;">Artifact Registry</h2>
        <a href="{% url 'upload_file' %}" class="btn-primary btn-sm">New Ingestion</a>
    </div>

    <table>
        <thead>
            <tr>
                <th>Artifact Name</th>
                <th>Status</th>
                <th>Ingestion Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for file in files %}
                <tr>
                    <td>
                        {{ file.original_filename }}
                        <br>
                        <small class="text-muted">{{ file.description|truncatechars:40 }}</small>
                    </td>
                    <td>
                        {% if file.status == 'CLEAN' %}
                            <span class="badge badge-clean">CLEAN</span>
                        {% elif file.status == 'REJECTED' %}
                            <span class="badge badge-rejected">REJECTED</span>
                        {% else %}
                            <span class="badge badge-pending">PENDING</span>
                        {% endif %}
                    </td>
                    <td>{{ file.uploaded_at|date:"Y-m-d H:i" }}</td>
                    <td>
                        {% if file.status == 'CLEAN' %}
                            <a href="{% url 'download_file' file.id %}" class="btn-primary btn-sm" style="text-decoration:none;">Download</a>
                        {% else %}
                            <span class="text-muted">Locked</span>
                        {% endif %}
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="4" class="empty-state">No artifacts in secure storage.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
